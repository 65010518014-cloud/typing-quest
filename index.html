<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö</title>

<style>
body{margin:0;font-family:'Segoe UI',sans-serif;background:#0f172a;color:#e5e7eb}
.container{max-width:1100px;margin:auto;padding:20px}
.card{background:#111827;border-radius:16px;padding:24px;margin-bottom:20px}
h1,h2,h3{text-align:center;color:#38bdf8}
.hidden{display:none}
input,select,button{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none}
input,select{background:#020617;color:#e5e7eb;border:1px solid #334155}
button{background:#38bdf8;color:#020617;font-weight:bold;cursor:pointer}
button.back{background:#64748b;color:#fff}
button.del{background:#ef4444;color:#fff}
.word-box{background:#020617;border:2px solid #334155;border-radius:14px;padding:20px;font-size:26px;text-align:center;min-height:120px}
.correct{color:#22c55e}
.wrong{color:#ef4444}
.pending{color:#64748b}
.timer{text-align:center;font-size:30px;color:#facc15}
table{width:100%;border-collapse:collapse}
th,td{padding:8px;border-bottom:1px solid #334155;text-align:center}
th{color:#38bdf8}
</style>
</head>

<body>
<div class="container">
<h1>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ö‡∏ô‡πÄ‡∏ß‡πá‡∏ö</h1>

<!-- LOGIN -->
<div class="card" id="loginPage">
<h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
<input id="loginUser" placeholder="Username">
<input id="loginPass" type="password" placeholder="Password">
<button onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
<button class="back" onclick="showRegister()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
</div>

<!-- REGISTER -->
<div class="card hidden" id="registerPage">
<h2>‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
<input id="r_name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
<input id="r_class" placeholder="‡∏ä‡∏±‡πâ‡∏ô">
<input id="r_no" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
<input id="r_user" placeholder="Username">
<input id="r_pass" type="password" placeholder="Password">
<button onclick="register()">‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
<button class="back" onclick="backLogin()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<!-- DASHBOARD -->
<div class="card hidden" id="dashboardPage">
<h2>‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</h2>

<select id="langSelect">
<option value="th">üáπüá≠ ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢</option>
<option value="en">üá¨üáß English</option>
</select>

<select id="roundTime">
<option value="1">‚è± 1 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
<option value="2">‚è± 2 ‡∏ô‡∏≤‡∏ó‡∏µ</option>
</select>

<button onclick="openMode('practice')">‡∏ù‡∏∂‡∏Å‡∏û‡∏¥‡∏°‡∏û‡πå</button>
<button onclick="openMode('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô')">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
<button onclick="openMode('‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô')">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
<button onclick="openStats()">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
<button class="back" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>

<!-- TYPING -->
<div class="card hidden" id="typingPage">
<h2 id="modeTitle"></h2>
<div class="word-box" id="wordBox"></div>
<input id="typingInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ">
<div class="timer" id="timeDisplay">00:00</div>
<button onclick="startTyping()">‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå</button>
<button class="back" onclick="goDashboard()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
</div>

<!-- STATS -->
<div class="card hidden" id="statsPage">
<h2>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</h2>

<button id="exportBtn" class="hidden" onclick="exportCSV()">üì• ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (CSV)</button>

<table id="resultTable"></table>

<h3 id="studentTitle" class="hidden">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (‡∏Ñ‡∏£‡∏π)</h3>
<table id="userTable"></table>

<button class="back" onclick="goDashboard()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
</div>
</div>

<script>
const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwiLRRhUOxzPL2Xpg12GCmlNGvDlU7wzfs5ZaGaaZitMPan7AZNmNLg5TtyfuDweH49cw/exec";

const teacher={user:"witthawat",pass:"1234"};
let users=JSON.parse(localStorage.getItem("users")||"[]");
let results=JSON.parse(localStorage.getItem("results")||"[]");
let currentUser=null;
let testType="",duration=1;

const lessons = {
  th: {
    1:["‡∏Å‡∏≤‡∏£|‡πÄ‡∏•‡πà‡∏ô|‡πÄ‡∏Å‡∏°|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÄ‡∏õ‡πá‡∏ô|‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°|‡∏ó‡∏µ‡πà|‡∏ä‡πà‡∏ß‡∏¢|‡∏™‡∏£‡πâ‡∏≤‡∏á|‡∏Ñ‡∏ß‡∏≤‡∏°|‡∏™‡∏ô‡∏∏‡∏Å|‡πÅ‡∏•‡∏∞|‡∏Ñ‡∏ß‡∏≤‡∏°|‡πÄ‡∏û‡∏•‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏¥‡∏ô|‡πÉ‡∏´‡πâ|‡∏Å‡∏±‡∏ö|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡πÉ‡∏ô|‡πÄ‡∏ß‡∏•‡∏≤‡∏ß‡πà‡∏≤‡∏á|‡πÄ‡∏Å‡∏°|‡∏ö‡∏≤‡∏á|‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó|‡∏ä‡πà‡∏ß‡∏¢|‡∏ù‡∏∂‡∏Å|‡∏ó‡∏±‡∏Å‡∏©‡∏∞|‡∏Å‡∏≤‡∏£|‡∏Ñ‡∏¥‡∏î|‡∏Å‡∏≤‡∏£|‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à|‡πÅ‡∏•‡∏∞|‡∏Å‡∏≤‡∏£|‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤|‡πÅ‡∏ï‡πà|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏Ñ‡∏ß‡∏£|‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å|‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°|‡πÄ‡∏ß‡∏•‡∏≤|‡πÑ‡∏°‡πà|‡πÄ‡∏•‡πà‡∏ô|‡πÄ‡∏Å‡∏°|‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô|‡∏ô‡∏≤‡∏ô|‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ|‡∏à‡∏ô|‡∏™‡πà‡∏á‡∏ú‡∏•|‡πÄ‡∏™‡∏µ‡∏¢|‡∏ï‡πà‡∏≠|‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û|‡πÅ‡∏•‡∏∞|‡∏Å‡∏≤‡∏£|‡πÄ‡∏£‡∏µ‡∏¢‡∏ô","‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÄ‡∏õ‡πá‡∏ô|‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠|‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç|‡πÉ‡∏ô|‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï|‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô|‡πÉ‡∏ä‡πâ|‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö|‡∏Å‡∏≤‡∏£|‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ|‡∏Å‡∏≤‡∏£|‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏ß‡πâ‡∏≤|‡πÅ‡∏•‡∏∞|‡∏Å‡∏≤‡∏£|‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£|‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏ß‡∏£|‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô|‡∏≠‡∏¢‡πà‡∏≤‡∏á|‡∏°‡∏µ|‡∏™‡∏ï‡∏¥|‡πÑ‡∏°‡πà|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÉ‡∏ô|‡∏ó‡∏≤‡∏á|‡∏ó‡∏µ‡πà|‡πÑ‡∏°‡πà|‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°|‡πÅ‡∏•‡∏∞|‡∏Ñ‡∏ß‡∏£|‡∏Ñ‡∏≥‡∏ô‡∏∂‡∏á|‡∏ñ‡∏∂‡∏á|‡∏Ñ‡∏ß‡∏≤‡∏°|‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢|‡∏Ç‡∏≠‡∏á|‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•|‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß","‡πÄ‡∏Å‡∏°|‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå|‡∏ï‡πâ‡∏≠‡∏á|‡∏≠‡∏≤‡∏®‡∏±‡∏¢|‡∏Å‡∏≤‡∏£|‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£|‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏´‡∏•‡∏≤‡∏¢|‡∏Ñ‡∏ô|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏Ñ‡∏ß‡∏£|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≥|‡∏™‡∏∏‡∏†‡∏≤‡∏û|‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û|‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô|‡πÅ‡∏•‡∏∞|‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏°|‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤|‡∏Å‡∏≤‡∏£|‡πÄ‡∏•‡πà‡∏ô|‡∏≠‡∏¢‡πà‡∏≤‡∏á|‡∏°‡∏µ|‡∏°‡∏≤‡∏£‡∏¢‡∏≤‡∏ó|‡∏à‡∏∞|‡∏ä‡πà‡∏ß‡∏¢|‡∏™‡∏£‡πâ‡∏≤‡∏á|‡∏™‡∏±‡∏á‡∏Ñ‡∏°|‡πÄ‡∏Å‡∏°|‡∏ó‡∏µ‡πà|‡∏î‡∏µ|‡πÅ‡∏•‡∏∞|‡∏ô‡πà‡∏≤|‡∏≠‡∏¢‡∏π‡πà","‡∏Å‡∏≤‡∏£|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÄ‡∏õ‡πá‡∏ô|‡πÄ‡∏ß‡∏•‡∏≤|‡∏ô‡∏≤‡∏ô|‡∏≠‡∏≤‡∏à|‡∏ó‡∏≥‡πÉ‡∏´‡πâ|‡πÄ‡∏Å‡∏¥‡∏î|‡∏≠‡∏≤‡∏Å‡∏≤‡∏£|‡∏õ‡∏ß‡∏î‡∏ï‡∏≤|‡∏õ‡∏ß‡∏î‡∏Ñ‡∏≠|‡πÅ‡∏•‡∏∞|‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏•‡πâ‡∏≤|‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏ß‡∏£|‡∏û‡∏±‡∏Å|‡∏™‡∏≤‡∏¢‡∏ï‡∏≤|‡∏ó‡∏∏‡∏Å|‡∏£‡∏∞‡∏¢‡∏∞|‡πÅ‡∏•‡∏∞|‡∏•‡∏∏‡∏Å|‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô|‡∏≠‡∏¥‡∏£‡∏¥‡∏¢‡∏≤‡∏ö‡∏ñ|‡πÄ‡∏û‡∏∑‡πà‡∏≠|‡∏•‡∏î|‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö|‡∏ï‡πà‡∏≠|‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û","‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô|‡∏Ñ‡∏ß‡∏£|‡πÄ‡∏•‡∏∑‡∏≠‡∏Å|‡πÄ‡∏Å‡∏°|‡∏ó‡∏µ‡πà|‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°|‡∏Å‡∏±‡∏ö|‡∏ß‡∏±‡∏¢|‡πÅ‡∏•‡∏∞|‡∏£‡∏∞‡∏î‡∏±‡∏ö|‡∏Ñ‡∏ß‡∏≤‡∏°|‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ|‡∏Ç‡∏≠‡∏á|‡∏ï‡∏ô‡πÄ‡∏≠‡∏á|‡πÑ‡∏°‡πà|‡∏Ñ‡∏ß‡∏£|‡πÄ‡∏•‡πà‡∏ô|‡πÄ‡∏Å‡∏°|‡∏ó‡∏µ‡πà|‡∏°‡∏µ|‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤|‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á|‡∏´‡∏£‡∏∑‡∏≠|‡πÑ‡∏°‡πà|‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°|‡πÄ‡∏û‡∏∑‡πà‡∏≠|‡∏™‡πà‡∏á‡πÄ‡∏™‡∏£‡∏¥‡∏°|‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°|‡∏ó‡∏µ‡πà|‡∏î‡∏µ"],
 2:[
 "‡πÉ‡∏ô|‡∏¢‡∏∏‡∏Ñ|‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡∏°‡∏µ|‡∏ö‡∏ó‡∏ö‡∏≤‡∏ó|‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç|‡∏ï‡πà‡∏≠|‡∏Å‡∏≤‡∏£|‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô|‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï|‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô|‡∏ó‡∏±‡πâ‡∏á|‡∏î‡πâ‡∏≤‡∏ô|‡∏Å‡∏≤‡∏£|‡πÄ‡∏£‡∏µ‡∏¢‡∏ô|‡∏Å‡∏≤‡∏£|‡∏ó‡∏≥‡∏á‡∏≤‡∏ô|‡πÅ‡∏•‡∏∞|‡∏Å‡∏≤‡∏£|‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£|‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô|‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÄ‡∏û‡∏∑‡πà‡∏≠|‡∏Ñ‡πâ‡∏ô‡∏Ñ‡∏ß‡πâ‡∏≤|‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•|‡∏ó‡∏≥|‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô|‡πÅ‡∏•‡∏∞|‡∏û‡∏±‡∏í‡∏ô‡∏≤|‡∏ó‡∏±‡∏Å‡∏©‡∏∞|‡πÉ‡∏´‡∏°‡πà|‡πÅ‡∏ï‡πà|‡∏ï‡πâ‡∏≠‡∏á|‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô|‡∏≠‡∏¢‡πà‡∏≤‡∏á|‡∏°‡∏µ|‡∏Ñ‡∏ß‡∏≤‡∏°|‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö|‡πÑ‡∏°‡πà|‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å|‡∏ú‡∏•‡∏á‡∏≤‡∏ô|‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô|‡πÅ‡∏•‡∏∞|‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û|‡∏•‡∏¥‡∏Ç‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå",
 "‡∏Å‡∏≤‡∏£|‡πÄ‡∏•‡πà‡∏ô|‡πÄ‡∏Å‡∏°|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÑ‡∏°‡πà|‡πÑ‡∏î‡πâ|‡∏°‡∏µ|‡πÅ‡∏ï‡πà|‡∏Ç‡πâ‡∏≠|‡πÄ‡∏™‡∏µ‡∏¢|‡πÄ‡∏™‡∏°‡∏≠|‡πÑ‡∏õ|‡πÄ‡∏Å‡∏°|‡∏´‡∏•‡∏≤‡∏¢|‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó|‡∏ä‡πà‡∏ß‡∏¢|‡∏ù‡∏∂‡∏Å|‡∏™‡∏°‡∏≤‡∏ò‡∏¥|‡∏Å‡∏≤‡∏£|‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô|‡πÅ‡∏•‡∏∞|‡∏Å‡∏≤‡∏£|‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏Ñ‡∏ß‡∏£|‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å|‡πÄ‡∏•‡∏∑‡∏≠‡∏Å|‡πÄ‡∏Å‡∏°|‡∏ó‡∏µ‡πà|‡∏°‡∏µ|‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå|‡πÅ‡∏•‡∏∞|‡πÄ‡∏•‡πà‡∏ô|‡πÉ‡∏ô|‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤|‡∏ó‡∏µ‡πà|‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°",
 "‡πÄ‡∏Å‡∏°|‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå|‡πÄ‡∏õ‡πá‡∏ô|‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà|‡∏ó‡∏µ‡πà|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏à‡∏≤‡∏Å|‡∏´‡∏•‡∏≤‡∏¢|‡∏ó‡∏µ‡πà|‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ|‡∏û‡∏ö‡∏Å‡∏±‡∏ô|‡πÑ‡∏î‡πâ|‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô|‡∏Ñ‡∏ß‡∏£|‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ï‡∏ô|‡∏≠‡∏¢‡πà‡∏≤‡∏á|‡∏™‡∏∏‡∏†‡∏≤‡∏û|‡πÑ‡∏°‡πà|‡∏Å‡∏•‡∏±‡πà‡∏ô‡πÅ‡∏Å‡∏•‡πâ‡∏á|‡∏ú‡∏π‡πâ‡∏≠‡∏∑‡πà‡∏ô|‡πÅ‡∏•‡∏∞|‡πÑ‡∏°‡πà|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≥|‡∏´‡∏¢‡∏≤‡∏ö‡∏Ñ‡∏≤‡∏¢|‡∏Å‡∏≤‡∏£|‡πÄ‡∏Ñ‡∏≤‡∏£‡∏û|‡∏Å‡∏±‡∏ô|‡∏à‡∏∞|‡∏ó‡∏≥‡πÉ‡∏´‡πâ|‡∏Å‡∏≤‡∏£|‡πÄ‡∏•‡πà‡∏ô|‡πÄ‡∏Å‡∏°|‡∏™‡∏ô‡∏∏‡∏Å|‡πÅ‡∏•‡∏∞|‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢",
 "‡∏Å‡∏≤‡∏£|‡∏î‡∏π‡πÅ‡∏•|‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û|‡∏Ç‡∏ì‡∏∞|‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå|‡πÄ‡∏õ‡πá‡∏ô|‡∏™‡∏¥‡πà‡∏á|‡∏ó‡∏µ‡πà|‡πÑ‡∏°‡πà|‡∏Ñ‡∏ß‡∏£|‡∏°‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏°|‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ|‡∏Ñ‡∏ß‡∏£|‡∏ô‡∏±‡πà‡∏á|‡πÉ‡∏´‡πâ|‡∏ñ‡∏π‡∏Å|‡∏ó‡πà‡∏≤|‡∏û‡∏±‡∏Å|‡∏™‡∏≤‡∏¢‡∏ï‡∏≤|‡πÄ‡∏õ‡πá‡∏ô|‡∏£‡∏∞‡∏¢‡∏∞|‡πÅ‡∏•‡∏∞|‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢|‡∏≠‡∏¢‡πà‡∏≤‡∏á|‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠|‡πÄ‡∏û‡∏∑‡πà‡∏≠|‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô|‡∏õ‡∏±‡∏ç‡∏´‡∏≤|‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û|‡πÉ‡∏ô|‡∏£‡∏∞‡∏¢‡∏∞|‡∏¢‡∏≤‡∏ß"
]

 },
 en:{
  1:["Playing|computer|games|is|an|activity|that|provides|fun|and|entertainment|for|many|people|in|their|free|time|Some|games|help|develop|thinking|decision|making|and|problem|solving|skills|However|players|should|control|their|gaming|time|to|avoid|negative|effects|on|health|and|education","Computers|are|important|tools|in|daily|life|They|are|used|for|learning|research|and|communication|Users|should|use|computers|carefully|and|be|aware|of|personal|data|security|when|working|online","Online|games|require|communication|between|many|players|Good|players|use|polite|language|respect|others|and|follow|the|rules|Good|manners|help|create|a|positive|gaming|community","Using|a|computer|for|long|periods|can|cause|eye|strain|neck|pain|and|fatigue|Users|should|take|regular|breaks|and|change|their|posture|to|reduce|health|problems","Students|should|choose|games|that|match|their|age|and|ability|They|should|avoid|games|with|violent|or|inappropriate|content|to|support|positive|behavior"],
  2:["In|the|digital|age|computers|play|an|important|role|in|daily|life|They|support|learning|working|and|communication|Students|can|use|computers|to|research|information|create|reports|and|develop|new|skills|They|must|use|technology|responsibly|and|respect|copyright","Playing|computer|games|is|not|always|harmful|Many|games|help|improve|concentration|planning|and|problem|solving|Players|should|select|useful|games|and|play|for|appropriate|amounts|of|time","Online|games|connect|players|from|many|places|Players|should|behave|politely|avoid|harassment|and|not|use|offensive|language|Respect|helps|make|gaming|fun|and|safe","Health|care|while|using|a|computer|should|not|be|ignored|Users|should|sit|with|proper|posture|rest|their|eyes|regularly|and|exercise|to|prevent|long|term|health|issues","When|students|use|computers|and|games|properly|technology|can|support|learning|skill|development|and|prepare|them|for|future|life|in|an|effective|way"]
 }
};

let words=[],lessonIndex=0,wordIndex=0;
let totalTyped=0,correct=0,wrong=0;
let timer,timeLeft,totalTime;

/* AUTH */
function showRegister(){loginPage.classList.add("hidden");registerPage.classList.remove("hidden")}
function backLogin(){registerPage.classList.add("hidden");loginPage.classList.remove("hidden")}
function register(){
 users.push({name:r_name.value,class:r_class.value,no:r_no.value,user:r_user.value,pass:r_pass.value});
 localStorage.setItem("users",JSON.stringify(users));
 alert("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢");
 backLogin();
}
function login(){
 if(loginUser.value===teacher.user && loginPass.value===teacher.pass)
  currentUser={name:"‡∏Ñ‡∏£‡∏π",user:"teacher",role:"teacher"};
 else{
  let u=users.find(x=>x.user===loginUser.value && x.pass===loginPass.value);
  if(!u) return alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ");
  currentUser={...u,role:"student"};
 }
 loginPage.classList.add("hidden");
 dashboardPage.classList.remove("hidden");
}
function logout(){location.reload()}

/* MODE */
function openMode(type){
  mode = type;
  duration = parseInt(roundTime.value);
  wordIndex = 0;
  words = [];

  let lang = langSelect.value;

  lessons[lang][duration].forEach(text=>{
    words.push(...text.split("|"));
  });

  dashboardPage.classList.add("hidden");
  typingPage.classList.remove("hidden");
  modeTitle.innerText = `${type} | ${duration} ‡∏ô‡∏≤‡∏ó‡∏µ`;

  startTyping();
}


/* TYPING */
function startTyping(){
 totalTyped=correct=wrong=0;
 wordIndex=0;
 timeLeft=duration*60;
 updateTime();
 render("");
 clearInterval(timer);
 timer=setInterval(()=>{
  timeLeft--;updateTime();
  if(timeLeft<=0) endTyping();
 },1000);
}
typingInput.addEventListener("input", ()=>{
  let v = typingInput.value;

  if(v.endsWith(" ")){
    totalTyped++;

    if(v.trim() === words[wordIndex]){
      correct++;
    }else{
      wrong++;
    }

    wordIndex++;          // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏õ‡∏Ñ‡∏≥‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
    typingInput.value = "";
  }

  render(typingInput.value.trim());
});
function render(input){
  let html = "";

  // ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡∏•‡∏∞ 5 ‡∏Ñ‡∏≥
  let start = wordIndex;
  let end = Math.min(wordIndex + 5, words.length);

  for(let i = start; i < end; i++){
    let w = words[i];

    if(i === wordIndex){
      // ‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå
      [...w].forEach((c,j)=>{
        if(j < input.length){
          html += input[j] === c
            ? `<span class="correct">${c}</span>`
            : `<span class="wrong">${c}</span>`;
        }else{
          html += `<span class="pending">${c}</span>`;
        }
      });
      html += " ";
    }else{
      // ‡∏Ñ‡∏≥‡∏ñ‡∏±‡∏î‡πÑ‡∏õ (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏¥‡∏°‡∏û‡πå)
      html += `<span class="pending">${w}</span> `;
    }
  }

  wordBox.innerHTML = html;
}

function updateTime(){
 timeDisplay.innerText=`${String(Math.floor(timeLeft/60)).padStart(2,"0")}:${String(timeLeft%60).padStart(2,"0")}`;
}
function endTyping(){
 clearInterval(timer);
 let wpm=Math.round(totalTyped/(duration));

 if(testType!=="practice"){
  // ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡πÄ‡∏î‡∏¥‡∏°)
  results.push({
    time:new Date().toLocaleString(),
    name:currentUser.name,
    user:currentUser.user,
    type:testType,
    duration,
    total:totalTyped,
    correct,
    wrong,
    wpm
  });
  localStorage.setItem("results",JSON.stringify(results));

  // ‚úÖ ‡∏™‡πà‡∏á‡πÑ‡∏õ Google Sheet
  fetch(GOOGLE_SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
      name: currentUser.name,
      user: currentUser.user,
      type: testType,
      duration: duration,
      correct: correct,
      wrong: wrong,
      wpm: wpm
    })
  }).catch(err => console.error("‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à", err));
 }

 alert(`‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${totalTyped} | ‡∏ñ‡∏π‡∏Å ${correct} | ‡∏ú‡∏¥‡∏î ${wrong} | ${wpm} ‡∏Ñ‡∏≥/‡∏ô‡∏≤‡∏ó‡∏µ`);
 goDashboard();
}

/* STATS */
function openStats(){
 dashboardPage.classList.add("hidden");
 statsPage.classList.remove("hidden");

 let data=currentUser.role==="teacher"?results:results.filter(r=>r.user===currentUser.user);
 resultTable.innerHTML=`<tr><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th><th>‡∏ô‡∏≤‡∏ó‡∏µ</th><th>‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</th><th>‡∏ñ‡∏π‡∏Å</th><th>‡∏ú‡∏¥‡∏î</th><th>‡∏Ñ‡∏≥/‡∏ô‡∏≤‡∏ó‡∏µ</th>${currentUser.role==="teacher"?"<th>‡∏•‡∏ö</th>":""}</tr>`+
 data.map((r,i)=>`<tr>
 <td>${r.time}</td><td>${r.name}</td><td>${r.type}</td><td>${r.duration}</td>
 <td>${r.total}</td><td>${r.correct}</td><td>${r.wrong}</td><td>${r.wpm}</td>
 ${currentUser.role==="teacher"?`<td><button class="del" onclick="delResult(${i})">‡∏•‡∏ö</button></td>`:""}
 </tr>`).join("");

 exportBtn.classList.toggle("hidden",currentUser.role!=="teacher");

 if(currentUser.role==="teacher"){
  studentTitle.classList.remove("hidden");
  userTable.innerHTML=`<tr><th>‡∏ä‡∏∑‡πà‡∏≠</th><th>User</th><th>‡∏•‡∏ö</th></tr>`+
  users.map((u,i)=>`<tr><td>${u.name}</td><td>${u.user}</td><td><button class="del" onclick="delUser(${i})">‡∏•‡∏ö</button></td></tr>`).join("");
 }
}
function delResult(i){results.splice(i,1);localStorage.setItem("results",JSON.stringify(results));openStats()}
function delUser(i){users.splice(i,1);localStorage.setItem("users",JSON.stringify(users));openStats()}
function exportCSV(){
 let csv="‡πÄ‡∏ß‡∏•‡∏≤,‡∏ä‡∏∑‡πà‡∏≠,‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó,‡∏ô‡∏≤‡∏ó‡∏µ,‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î,‡∏ñ‡∏π‡∏Å,‡∏ú‡∏¥‡∏î,‡∏Ñ‡∏≥‡∏ï‡πà‡∏≠‡∏ô‡∏≤‡∏ó‡∏µ\n";
 results.forEach(r=>csv+=`${r.time},${r.name},${r.type},${r.duration},${r.total},${r.correct},${r.wrong},${r.wpm}\n`);
 let blob=new Blob([csv],{type:"text/csv"});
 let a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download="typing_results.csv";
 a.click();
}
function goDashboard(){
 typingPage.classList.add("hidden");
 statsPage.classList.add("hidden");
 dashboardPage.classList.remove("hidden");
}
</script>
</body>
</html>
